<app-header></app-header>

<div class="detail-wrap">
  <!-- Single block drives all 3 steps off currentPage() -->
  <div class="page-content">
    <!-- Header with dynamic title/sub + step -->
    <div class="page-head">
      <div>
        <h1>
          {{
            [
              'Page 1: Select Activities',
              'Page 2: Select Food Preferences',
              'Page 3: Select Your Budget Level'
            ][currentPage()]
          }}
        </h1>
        <p class="sub">
          {{
            [
              'Please choose what activities interest you the most!',
              'Choose what interests you most.',
              'We will do our best to align with your budget!'
            ][currentPage()]
          }}
        </p>
      </div>
      <span class="step">{{ currentPage() + 1 }} / {{ maxPages }}</span>
    </div>

    <!-- Chips -->
    <div class="interests-field chip-cloud">
      <mat-chip-listbox #chipList [multiple]="true" aria-label="preferences">
        <mat-chip-option
          *ngFor="let interest of currentOptions"
          [selected]="currentSelections.includes(interest)"
          (selectionChange)="toggleSelection($event, interest)"
        >
          {{ interest }}
        </mat-chip-option>
      </mat-chip-listbox>

      <!-- Custom option -->
    
<mat-form-field
  *ngIf="!isBudgetPage()"         
  appearance="outline"
  class="custom-option-field"
>
  <mat-label>Add your own {{ currentType }}</mat-label>
  <input
    matInput
    [(ngModel)]="newOptionInput"
    placeholder="Type your option here..."
    (keyup.enter)="addCustomOption()"
  />
  <button
    mat-icon-button
    matSuffix
    (click)="addCustomOption()"
    [disabled]="!newOptionInput.trim()"
  >
    <mat-icon>add</mat-icon>
  </button>
</mat-form-field>

    </div>
  </div>

  <!-- Navigation -->
  <div class="navigation-buttons sticky-actions">
    <button mat-stroked-button color="primary" (click)="prevPage()" [disabled]="isFirstPage()">
      Back
    </button>

    <button mat-flat-button color="primary" (click)="nextPage()" *ngIf="!isLastPage()">
      Continue
    </button>

    <button mat-flat-button color="primary" (click)="submitInterests()" *ngIf="isLastPage()">
      Save preferences
    </button>
  </div>
</div>
